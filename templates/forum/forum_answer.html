{% load static %}

<style>
    .answer-content,
    .answer-content * {
        color: #696e79 !important;
        font-size: 0.875rem !important;
        background-color: transparent !important;
    }
</style>
<style>
    [x-cloak] {
        display: none !important;
    }
</style>

<div class="flex items-center gap-2 pl-4 ml-5 mx-auto">
    <h3 class="text-2xl text-gray-900 font-inter">{{ particular_question.answers.count }} Answer</h3>
    <svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18" viewBox="0 0 18 18">
        <path d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"></path>
    </svg>
</div>



{% comment %} Dropdown menu {% endcomment %}
<div x-data="{ open: false }" class="flex items-center gap-4 mb-5 relative ml-5 max-w-7xl mx-auto" x-cloak>

    <!-- Sort By Dropdown -->
    <div class="relative mx-auto" @click.away="open = false">
        <div class="flex items-center gap-1 mx-auto">
            <span class="font-inter text-sm text-gray-600 ml-4">Sort by:</span>

            <!-- Dropdown trigger -->
            <button @click="open = !open" :class="{'bg-gray-200': open}" class="font-semibold font-inter text-sm text-gray-600 ml-2 py-2 px-2 flex items-center gap-1 rounded-2xl hover:bg-gray-200 transition-colors">
                {{ current_sort|default:"Best" }}
                <svg rpl="" fill="currentColor" height="16" icon-name="caret-down-outline" viewBox="0 0 20 20"
                    width="16" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M10 13.7a.897.897 0 01-.636-.264l-4.6-4.6a.9.9 0 111.272-1.273L10 11.526l3.964-3.963a.9.9 0 011.272 1.273l-4.6 4.6A.897.897 0 0110 13.7z">
                    </path>
                </svg>
            </button>
        </div>

        <!-- Dropdown menu -->
        <div x-show="open" x-transition class="absolute mt-2 ml-12 w-36 bg-white border rounded-2xl shadow-lg z-10" x-cloak>
            <a hx-get="{% url 'questions' slug=particular_question.slug %}?sort=best" hx-target="#blog_post_form" hx-swap="innerHTML" @click="open = false" class="px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center gap-2 bg-gray-100 rounded"> <svg rpl="" fill="currentColor" height="20" icon-name="best-outline" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M15.22 8.6c-.6-3.51-2.68-6.21-4.76-7.47a.912.912 0 00-.93 0C7.59 2.3 5.37 4.89 4.76 8.61c-2.77 2.65-4.02 4.46-3.57 7.32.17 1.08 1.14 1.9 2.27 1.9h3.18c.61.72 1.53 1.17 2.51 1.17h1.71c.98 0 1.9-.44 2.51-1.17h3.18c1.12 0 2.1-.82 2.27-1.9.45-2.87-.8-4.67-3.59-7.33h-.01zM2.97 15.65c-.24-1.53.15-2.65 1.66-4.33.1 1.83.55 3.45 1.06 4.71H3.46c-.24 0-.45-.17-.49-.38zm6.18 1.55c-.57 0-1.09-.32-1.33-.81-.64-1.31-1.41-3.37-1.41-5.78 0-3.71 1.84-6.34 3.6-7.63 1.81 1.35 3.6 4.16 3.6 7.63 0 2.41-.77 4.47-1.41 5.78-.24.49-.77.81-1.33.81H9.15zm7.88-1.55c-.03.21-.25.38-.49.38h-2.23c.51-1.26.96-2.88 1.06-4.71 1.51 1.69 1.9 2.8 1.66 4.33z">
                    </path>
                    <path
                        d="M10 8.35c-.91 0-1.65.74-1.65 1.65 0 .91.74 1.65 1.65 1.65.91 0 1.65-.74 1.65-1.65 0-.91-.74-1.65-1.65-1.65z">
                    </path>
                </svg>
                <span>Best</span>
            </a>

            <a hx-get="{% url 'questions' slug=particular_question.slug %}?sort=old" hx-target="#blog_post_form" hx-swap="innerHTML" @click="open = false" class="px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center gap-2"> <svg rpl="" fill="currentColor" height="20" icon-name="new-outline" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 10.9H4.68V9.1H9.1V4.68h1.8V10c0 .5-.4.9-.9.9z"></path>
                    <path
                        d="M13.3 16.39c-.99.51-2.11.81-3.3.81-3.97 0-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8c3.22 0 5.96 2.13 6.87 5.06.05.02.11.03.16.05.33.14.63.33.88.58l1.07 1.07C18.75 4.8 14.82 1 10 1s-9 4.03-9 9a9 9 0 009 9c1.17 0 2.28-.23 3.3-.63v-1.98z">
                    </path>
                    <path
                        d="M19.64 12.76l-3-3a.915.915 0 00-1.27 0l-3 3a.9.9 0 000 1.27.9.9 0 001.27 0l1.46-1.46v6.03c0 .5.4.9.9.9s.9-.4.9-.9v-6.03l1.46 1.46c.18.18.41.26.64.26.23 0 .46-.09.64-.26a.9.9 0 000-1.27z">
                    </path>
                </svg>
                <span>Old</span>
            </a>
            <a hx-get="{% url 'questions' slug=particular_question.slug %}?sort=top" hx-target="#blog_post_form" hx-swap="innerHTML" @click="open = false" class="px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center gap-2"> <svg rpl="" fill="currentColor" height="20" icon-name="top-outline" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M17.1 11.03h-3.3V8.98h1.17a1.328 1.328 0 00.94-2.27l-5.27-5.28c-.34-.34-.94-.34-1.27 0L4.09 6.71c-.38.38-.49.95-.29 1.45.21.5.69.82 1.23.82H6.2v2.05H2.9a1.9 1.9 0 00-1.9 1.9v2.6c0 1.82 1.48 3.3 3.3 3.3h11.4c1.82 0 3.3-1.48 3.3-3.3v-2.6a1.9 1.9 0 00-1.9-1.9zM10 3.34l3.83 3.84H12v7.85c0 1.1-.9 2-2 2s-2-.9-2-2V7.18H6.17L10 3.34zM2.8 15.52v-2.6c0-.06.04-.1.1-.1h3.3v2.2c0 .74.22 1.42.58 2H4.3c-.83 0-1.5-.67-1.5-1.5zm14.4 0c0 .83-.67 1.5-1.5 1.5h-2.48c.36-.58.58-1.26.58-2v-2.2h3.3c.05 0 .1.04.1.1v2.6z">
                    </path>
                </svg>
                <span>Top</span>
            </a>
            <a hx-get="{% url 'questions' slug=particular_question.slug %}?sort=recently" hx-target="#blog_post_form" hx-swap="innerHTML" hx-push-url="true" @click="open = false" class="px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center gap-2"> <svg rpl="" fill="currentColor" height="20" icon-name="author" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M17.536 2.465a5.006 5.006 0 00-7.072 0 4.98 4.98 0 00-1.458 3.503 1.934 1.934 0 00-.437-.023 1.903 1.903 0 00-1.388.759l-5.457 7.319c-.925 1.24-.806 2.87.288 3.965a3.015 3.015 0 002.14.908c.631 0 1.268-.205 1.826-.621l7.317-5.457a1.9 1.9 0 00.761-1.386 1.892 1.892 0 00-.022-.44 4.982 4.982 0 003.502-1.458 5.006 5.006 0 000-7.07zm-5.316 8.91l-7.318 5.457c-.633.474-1.249.25-1.617-.117-.366-.366-.589-.983-.117-1.616l5.457-7.32.15-.01L9.867 8.86l-2.162 2.162 1.273 1.272 2.162-2.162 1.091 1.09-.01.152zm4.043-3.112c-1.209 1.209-3.316 1.209-4.525 0a3.204 3.204 0 010-4.525 3.18 3.18 0 012.263-.938c.855 0 1.658.333 2.263.938a3.204 3.204 0 010 4.525z">
                    </path>
                </svg>
                <span>Recently</span>
            </a>

        </div>


    </div>

    <!-- Search Bar -->
    <div class="flex-1 mx-auto">
        <form hx-get="{% url 'questions' slug=particular_question.slug %}" hx-target="#blog_post_form" hx-swap="innerHTML">
            <div class="relative w-full max-w-md mx-auto group ">
                <span class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none ">
            <svg fill="currentColor " height="18 " viewBox="0 0 20 20 " width="18 " xmlns="http://www.w3.org/2000/svg " class="text-gray-400 group-focus-within:text-blue-500 transition-colors ">
                <path d="M18.736 17.464l-3.483-3.483A7.961 7.961 0 0016.999 9 8 8 0 109 17a7.961 7.961 0 004.981-1.746l3.483 3.483a.9.9 0 101.272-1.273zM9 15.2A6.207 6.207 0 012.8 9c0-3.419 2.781-6.2 6.2-6.2s6.2 2.781 6.2 6.2-2.781 6.2-6.2 6.2z "></path>
            </svg>
        </span>

                <input type="search" name="q" value="{{ query|default:'' }}" placeholder="Search answers... " class="w-full pl-11 pr-24 py-2 rounded-full border border-gray-300 bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-100
            focus:border-blue-400 shadow-sm transition-all " />

                <button type="submit " class="absolute right-1.5 top-1.5 bottom-1.5 px-5 bg-gray-400 hover:bg-gray-500 text-white text-sm font-medium rounded-full transition-all active:scale-95 shadow-sm ">
            Search
        </button>
            </div>
        </form>
    </div>

</div>




{% comment %} answer section {% endcomment %}
<div class="relative pl-3 ml-5 ">
    <!-- Full Vertical Line  -->
    {% if paginator_answer %}
    <div class="absolute top-0 bottom-0 left-5 w-0.5 bg-gray-300 "></div>
    {% endif %} {% for answer in paginator_answer %}
    <!-- Step 1 -->
    <div class="mb-8 relative flex items-start space-x-4 ">
        <!-- Circle -->
        <div class="relative z-10 w-6 h-6 rounded-full bg-gray-400 text-white flex justify-center items-center ">{{ paginator_answer.start_index|add:forloop.counter0 }}</div>

        <!-- Content Box -->
        <div class="bg-white w-full pt-1 pb-2 rounded-lg ">
            <div class="flex items-start gap-3 ">
                <img src="{{ answer.author.profile_picture.url }} " class="w-7 h-7 rounded-full object-cover border " />
                <div class="flex flex-col leading-tight w-full ">
                    <div class="flex items-center justify-between w-full ">
                        <span class="font-inter text-md font-semibold text-gray-600 hover:text-blue-500 cursor-pointer ">
                            {{ answer.author.first_name }} {{ answer.author.last_name }}
                        </span>

                        <div class="flex items-center gap-1 ">
                            <span class="text-green-600 ">â€¢</span>
                            <span class="font-inter text-[12px] text-gray-400 ">
                                {{ answer.created_at|timesince|slice:"25 " }} ago
                            </span>
                        </div>
                    </div>

                    <span class="text-sm text-gray-500 ">
                    </span>
                </div>
            </div>
            <div class="answer-content ">
                <p class="mt-2 text-sm ">{{ answer.content|safe }}</p>
            </div>
            <!-- Interaction Bar -->
            <!-- <div class="flex items-center gap-3 mt-2 ">
                <a class="flex items-center gap-1 bg-gray-100 rounded-2xl px-2 py-1 text-sm ">
                    <i class="fa-regular fa-thumbs-up "></i> 36
                </a>
                <a class="flex items-center gap-1 bg-gray-100 rounded-2xl px-2 py-1 text-sm ">
                    <i class="fa-regular fa-comment "></i> 24
                </a>
            </div> -->
        </div>
    </div>
    {% endfor %}
    <!-- paginator section -->
    {% if paginator_answer %}
    <div class="mt-16 mb-10 flex justify-center ">
        <nav class="flex items-center gap-1 p-1 bg-white/80 backdrop-blur-md border border-gray-200/60 rounded-2xl shadow-sm ring-1 ring-black/5 " aria-label="Pagination ">

            {% if paginator_answer.has_previous %}
            <a href="?page={{ paginator_answer.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %} " class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all
            duration-200 " title="Previous ">
                <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 "><path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M15 19l-7-7 7-7 "/></svg>
            </a>
            {% else %}
            <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed ">
            <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 "><path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M15 19l-7-7 7-7 "/></svg>
        </span> {% endif %}

            <div class="flex items-center px-4 h-10 bg-gray-50/50 rounded-xl border border-gray-100 mx-1 ">
                <span class="text-xs font-bold uppercase tracking-widest text-gray-400 mr-2 ">Page</span>
                <span class="text-sm font-semibold text-blue-600 ">{{ paginator_answer.number }}</span>
                <span class="text-sm font-medium text-gray-300 mx-2 ">of</span>
                <span class="text-sm font-semibold text-gray-600 ">{{ paginator_answer.paginator.num_pages }}</span>
            </div>

            {% if paginator_answer.has_next %}
            <a href="?page={{ paginator_answer.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %} " class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all
            duration-200 " title="Next ">
                <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 "><path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M9 5l7 7-7 7 "/></svg>
            </a>
            {% else %}
            <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed ">
            <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 "><path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M9 5l7 7-7 7 "/></svg>
        </span> {% endif %}

        </nav>
    </div>
    {% endif %}


</div>



<!-- Auto Adjust Line Heights -->
<script>
    document.querySelectorAll('.step-item').forEach((step, index, steps) => {
        const line = step.querySelector('.step-line');
        if (index === 0) {
            line.style.top = '12px'; // First one starts from middle of circle
        }

        if (index === steps.length - 1) {
            line.style.height = '12px'; // Last one ends at circle center
        } else {
            line.style.height = step.offsetHeight + 12 + 'px';
        }
    });
</script>