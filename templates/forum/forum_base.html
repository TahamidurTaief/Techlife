{% load static %}

<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />



    <!-- Primary Meta Tags -->
    <title>
        {% block title %} TechLife || Know The Current Situation {% endblock title %}
    </title>
    {% comment %} {% tailwind_css %} {% endcomment %}
    <meta name="description" content="{% block meta_description %}Discover a wide range of high-quality products at unbeatable prices. Your one-stop shop for electronics, fashion, and more.{% endblock meta_description %}" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ request.build_absolute_uri }}" />
    <meta property="og:title" content="{% block og_title %}{% block title_for_socials %}{{ self.title }}{% endblock %}{% endblock %}" />
    <meta property="og:description" content="{% block og_description %}{% block description_for_socials %}{{ self.meta_description }}{% endblock %}{% endblock %}" />
    <meta property="og:image" content="{% block og_image %}{% static 'images/default_og_image.png' %}{% endblock og_image %}" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="{{ request.build_absolute_uri }}" />
    <meta property="twitter:title" content="{% block twitter_title %}{% block title_for_socials_twitter %}{{ self.og_title }}{% endblock %}{% endblock %}" />
    <meta property="twitter:description" content="{% block twitter_description %}{% block description_for_socials_twitter %}{{ self.og_description }}{% endblock %}{% endblock %}" />
    <meta property="twitter:image" content="{% block twitter_image %}{% block og_image_twitter %}{{ self.og_image }}{% endblock %}{% endblock %}" />

    <!-- HTMX CSRF -->
    {% csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token }}" />




    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="{% static 'css/output.css' %}" />

    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" /> {% comment %} use for markdown editor {% endcomment %} {% comment %}
    <!-- SimpleMDE CSS -->
    <link rel="stylesheet" h ref="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">

    <!-- SimpleMDE JS -->
    <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script> {% endcomment %}

    <!-- CKEditor 5 Classic Build -->
    <script src="https://cdn.ckeditor.com/ckeditor5/41.4.2/classic/ckeditor.js"></script>










    <!-- HTMX & Alpine.js -->
    <script src="https://unpkg.com/htmx.org@1.9.12" xintegrity="sha384-qbtR4rS9adLkqseSremUcbR/vgFA2A6XPKYoHCi8S4EbMLjI/RJjVqEX+qtYLaqd" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.0/dist/cdn.min.js" defer></script>


    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>



    <!-- Font Awesome Free CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Fonts Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet"> {% block extra_head %} {% endblock extra_head %}


    <!-- for question modal -->
    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .modal-overlay {
            animation: fadeIn 0.4s ease-out;
        }
        
        .modal-content {
            animation: slideUp 0.5s ease-out;
        }
        
        .modal-overlay.closing {
            animation: fadeIn 0.3s ease-out reverse;
        }
        
        .modal-content.closing {
            animation: slideUp 0.4s ease-out reverse;
        }
    </style>

    <style>
        html::-webkit-scrollbar {
            display: none;
        }
        
        html {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>

    <!-- for responsive -->
    <style>
        /* Add this to your main CSS file or in a <style> tag in the base template */
        /* Ensure proper box-sizing */
        
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }
        /* Smooth scrolling */
        
        html {
            scroll-behavior: smooth;
        }
        /* Body layout */
        
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        /* Main content area should grow to fill available space */
        
        main {
            flex: 1;
            min-height: calc(100vh - 4rem);
            /* 4rem for navbar height */
        }
        /* Responsive container max-widths */
        
        @media (min-width: 640px) {
            .responsive-container {
                max-width: 640px;
            }
        }
        
        @media (min-width: 768px) {
            .responsive-container {
                max-width: 768px;
            }
        }
        
        @media (min-width: 1024px) {
            .responsive-container {
                max-width: 1024px;
            }
        }
        
        @media (min-width: 1280px) {
            .responsive-container {
                max-width: 1280px;
            }
        }
        
        @media (min-width: 1536px) {
            .responsive-container {
                max-width: 1400px;
            }
        }
        /* Sidebar transitions */
        
        #sidebar {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        /* Mobile sidebar overlay */
        
        @media (max-width: 767px) {
            #sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 40;
            }
            #sidebar.active {
                transform: translateX(0) !important;
            }
        }
        /* Desktop sidebar */
        
        @media (min-width: 768px) {
            #sidebar {
                position: sticky;
                top: 4rem;
                /* Height of navbar */
                height: calc(100vh - 4rem);
            }
        }
        /* Prevent layout shift on scroll */
        
        .navbar {
            position: sticky;
            top: 0;
            z-index: 50;
            width: 100%;
        }
        /* Modal z-index hierarchy */
        
        .question-modal-overlay {
            z-index: 9999;
        }
        
        #sidebarBackdrop {
            z-index: 30;
        }
        
        @media (min-width: 768px) {
            #sidebarBackdrop {
                display: none;
            }
        }
        /* Scrollbar styling for webkit browsers */
        
        .custom-scroll {
            scrollbar-width: thin;
            scrollbar-color: #ccc #f1f1f1;
        }
        
        .custom-scroll::-webkit-scrollbar {
            width: 5px;
        }
        
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 10px;
        }
        
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #888;
        }
        /* Responsive text truncation */
        
        .truncate-2-lines {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .truncate-3-lines {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        /* Responsive grid gaps */
        
        @media (max-width: 640px) {
            .grid {
                gap: 1rem;
            }
        }
        /* Ensure buttons don't shrink */
        
        button,
        a[role="button"] {
            flex-shrink: 0;
        }
        /* Responsive image handling */
        
        img {
            max-width: 100%;
            height: auto;
        }
        /* Fix for modal content overflow */
        
        .question-modal-container {
            max-height: 90vh;
            overflow-y: auto;
        }
        /* Smooth modal transitions */
        
        .question-modal-overlay {
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        
        .question-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        /* Responsive padding adjustments */
        
        @media (max-width: 640px) {
            .main-content-padding {
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }
        
        @media (min-width: 641px) and (max-width: 1023px) {
            .main-content-padding {
                padding-left: 1.5rem;
                padding-right: 1.5rem;
            }
        }
        
        @media (min-width: 1024px) {
            .main-content-padding {
                padding-left: 2rem;
                padding-right: 2rem;
            }
        }
        /* Prevent horizontal scroll */
        
        body,
        html {
            overflow-x: hidden;
        }
        /* Responsive flex utilities */
        
        @media (max-width: 640px) {
            .flex-col-mobile {
                flex-direction: column;
            }
        }
        /* Touch device improvements */
        
        @media (hover: none) and (pointer: coarse) {
            button,
            a {
                min-height: 44px;
                min-width: 44px;
            }
        }
        /* Focus visible for accessibility */
        
        *:focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }
        /* Responsive font sizes */
        
        @media (max-width: 640px) {
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.25rem;
            }
            h3 {
                font-size: 1.125rem;
            }
        }
        
        @media (min-width: 641px) and (max-width: 1023px) {
            h1 {
                font-size: 1.875rem;
            }
            h2 {
                font-size: 1.5rem;
            }
            h3 {
                font-size: 1.25rem;
            }
        }
        
        @media (min-width: 1024px) {
            h1 {
                font-size: 2.25rem;
            }
            h2 {
                font-size: 1.875rem;
            }
            h3 {
                font-size: 1.5rem;
            }
        }
        /* Safe area insets for mobile devices with notches */
        
        @supports (padding: max(0px)) {
            body {
                padding-left: max(0px, env(safe-area-inset-left));
                padding-right: max(0px, env(safe-area-inset-right));
            }
        }
        /* Loading states */
        
        .loading {
            pointer-events: none;
            opacity: 0.6;
        }
        /* Transition utilities */
        
        .transition-smooth {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        /* Print styles */
        
        @media print {
            #sidebar,
            .navbar,
            footer,
            button {
                display: none !important;
            }
            main {
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }
        }
    </style>
</head>

<body class="bg-gray-50 leading-normal tracking-normal min-h-screen flex flex-col">



    <!-- modal  -->
    <!-- Modal Overlay -->
    <div id="modalOverlay" class="modal-overlay fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <!-- Modal Content -->
        <div class="modal-content bg-white rounded-lg shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800">Create New Question</h2>
                <button id="closeBtn" class="text-gray-400 hover:text-gray-600 transition-colors duration-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Modal Body -->
            <form id="questionForm" class="p-6 space-y-6">
                <!-- Title Input -->
                <div>
                    <label for="title" class="block text-sm font-semibold text-gray-700 mb-2">
                        Question Title <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="title" name="title" required maxlength="200" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 outline-none" placeholder="Enter your question title...">
                </div>

                <!-- Content Textarea -->
                <div>
                    <label for="content" class="block text-sm font-semibold text-gray-700 mb-2">
                        Question Details <span class="text-red-500">*</span>
                    </label>
                    <textarea id="content" name="content" required rows="6" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 outline-none resize-none" placeholder="Describe your question in detail..."></textarea>
                </div>

                <!-- Image Upload -->
                <div>
                    <label for="image" class="block text-sm font-semibold text-gray-700 mb-2">
                        Upload Image (Optional)
                    </label>
                    <div class="relative">
                        <input type="file" id="image" name="image" accept="image/*" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 outline-none file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 file:cursor-pointer">
                    </div>
                    <p id="imagePreview" class="mt-2 text-sm text-gray-500"></p>
                </div>

                <!-- Form Actions -->
                <div class="flex items-center justify-end gap-4 pt-4">
                    <button type="button" id="cancelBtn" class="px-6 py-3 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-all duration-300 font-medium">
                        Cancel
                    </button>
                    <button type="submit" class="px-6 py-3 text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-300 font-medium shadow-lg hover:shadow-xl">
                        Create Question
                    </button>
                </div>
            </form>
        </div>
    </div>


    <!-- Success Message -->
    <div id="successMessage" class="hidden fixed top-4 right-4 bg-green-500 text-white px-6 py-4 rounded-lg shadow-lg z-50">
        <div class="flex items-center gap-2">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span class="font-medium">Question created successfully!</span>
        </div>
    </div>



    {% include 'forum/forum_navbar.html' %}



    <div class="flex-1 flex">
        <!-- Sidebar -->
        <!-- Sidebar -->
        <div class="w-full max-w-[1400px] mx-auto flex">
            <aside class="flex-shrink-0">
                {% include 'forum/forum_sidebar.html' %}
            </aside>

            <!-- Main Content -->
            <main id="blog_post_form" class="flex-1 min-w-0 bg-white">
                <div class="w-full h-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6">
                    {% block content %} {% if action == 'question_list' %} {% include 'forum/partial_all_question.html' %} {% elif action == 'popular_questions' %} {% include 'forum/partial_popular_question.html' %} {% elif action == 'all_user' %} {% include 'forum/partial_forum_user.html'
                    %} {% elif action == 'user_profile_details' %} {% include 'forum/partial_forum_user_profile.html' %} {% elif action == 'question_details' %} {% include 'forum/partial_question_page.html' %} {% endif %} {% endblock content %}
                </div>
            </main>
        </div>
    </div>
    {% include 'forum/forum_footer.html' %}


    <script src="https://unpkg.com/lucide@latest "></script>
    <script>
        lucide.createIcons();
    </script>

    <!-- DaisyUI Play CDN -->
    {% comment %}
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4 "></script> {% endcomment %}

    <!-- tailwind -->
    {% comment %}
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4 "></script> {% endcomment %}

    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.12 "></script>

    <!-- HTMX Configuration & Loading States -->
    <script>
        // HTMX Loading indicator
        document.body.addEventListener('htmx:beforeRequest', function(evt) {
            // Add loading class to content area
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '0.6';
                content.style.transition = 'opacity 0.2s ease';
            }
        });

        document.body.addEventListener('htmx:afterRequest', function(evt) {
            // Remove loading state
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '1';
            }
        });

        // Handle errors gracefully
        document.body.addEventListener('htmx:responseError', function(evt) {
            console.error('HTMX Error:', evt.detail);
            const content = document.getElementById('content');
            if (content) {
                content.innerHTML = `
          <div class="flex flex-col items-center justify-center min-h-[400px] text-center ">
            <h2 class="text-xl font-bold text-red-600 mb-4 ">Something went wrong</h2>
            <p class="text-gray-600 mb-6 ">Unable to load the content. Please try again.</p>
            <button onclick="window.location.reload() " 
                    class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors ">
              Refresh Page
            </button>
          </div>
        `;
                content.style.opacity = '1';
            }
        });

        document.body.addEventListener('htmx:afterSettle', function(evt) {
            const titleElement = evt.detail.target.querySelector('title, [data-title]');
            if (titleElement) {
                document.title = titleElement.textContent || titleElement.getAttribute('data-title');
            }
        });

        document.body.addEventListener('htmx:historyRestore', function(evt) {
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '1';
            }
        });

        document.body.addEventListener('htmx:beforeHistorySave', function(evt) {
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '1';
            }
        });
    </script>


    <!-- for responsive -->

    <script>
        // Add this JavaScript file to your project for enhanced responsive behavior

        // Responsive utilities
        const ResponsiveUtils = {
            // Check if device is mobile
            isMobile: () => window.innerWidth < 768,

            // Check if device is tablet
            isTablet: () => window.innerWidth >= 768 && window.innerWidth < 1024,

            // Check if device is desktop
            isDesktop: () => window.innerWidth >= 1024,

            // Get current breakpoint
            getBreakpoint: () => {
                const width = window.innerWidth;
                if (width < 640) return 'mobile';
                if (width < 768) return 'sm';
                if (width < 1024) return 'md';
                if (width < 1280) return 'lg';
                if (width < 1536) return 'xl';
                return '2xl';
            }
        };

        // Sidebar management
        class SidebarManager {
            constructor() {
                this.sidebar = document.getElementById('sidebar');
                this.backdrop = document.getElementById('sidebarBackdrop');
                this.toggleBtn = document.getElementById('toggleSidebar');
                this.openIcon = document.getElementById('openIcon');
                this.closeIcon = document.getElementById('closeIcon');

                this.init();
            }

            init() {
                if (!this.sidebar) return;

                // Toggle button click
                if (this.toggleBtn) {
                    this.toggleBtn.addEventListener('click', () => this.toggle());
                }

                // Backdrop click
                if (this.backdrop) {
                    this.backdrop.addEventListener('click', () => this.close());
                }

                // Close on escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && !this.sidebar.classList.contains('-translate-x-full')) {
                        this.close();
                    }
                });

                // Handle window resize
                let resizeTimer;
                window.addEventListener('resize', () => {
                    clearTimeout(resizeTimer);
                    resizeTimer = setTimeout(() => {
                        if (!ResponsiveUtils.isMobile()) {
                            this.close();
                        }
                    }, 250);
                });

                // Close sidebar when clicking links on mobile
                if (ResponsiveUtils.isMobile()) {
                    const links = this.sidebar.querySelectorAll('a');
                    links.forEach(link => {
                        link.addEventListener('click', () => {
                            setTimeout(() => this.close(), 300);
                        });
                    });
                }
            }

            toggle() {
                const isOpen = !this.sidebar.classList.contains('-translate-x-full');
                if (isOpen) {
                    this.close();
                } else {
                    this.open();
                }
            }

            open() {
                this.sidebar.classList.remove('-translate-x-full');
                if (this.backdrop) this.backdrop.classList.add('active');
                if (this.openIcon) this.openIcon.classList.add('hidden');
                if (this.closeIcon) this.closeIcon.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }

            close() {
                this.sidebar.classList.add('-translate-x-full');
                if (this.backdrop) this.backdrop.classList.remove('active');
                if (this.openIcon) this.openIcon.classList.remove('hidden');
                if (this.closeIcon) this.closeIcon.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        // Modal management
        class ModalManager {
            constructor(modalId) {
                this.modal = document.getElementById(modalId);
                this.init();
            }

            init() {
                if (!this.modal) return;

                // Close on backdrop click
                this.modal.addEventListener('click', (e) => {
                    if (e.target === this.modal) {
                        this.close();
                    }
                });

                // Close on escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.modal.classList.contains('active')) {
                        this.close();
                    }
                });

                // Find and bind close buttons
                const closeButtons = this.modal.querySelectorAll('[data-modal-close]');
                closeButtons.forEach(btn => {
                    btn.addEventListener('click', () => this.close());
                });
            }

            open() {
                if (!this.modal) return;
                this.modal.classList.add('active');
                document.body.style.overflow = 'hidden';

                // Focus trap
                const focusableElements = this.modal.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                if (focusableElements.length > 0) {
                    focusableElements[0].focus();
                }
            }

            close() {
                if (!this.modal) return;
                this.modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        // Global modal functions
        window.openModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        };

        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        };

        // Question modal specific function
        window.openQuestionModal = function() {
            const modal = document.getElementById('questionModalOverlay');
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        };

        // Smooth scroll to element
        function smoothScrollTo(elementId, offset = 80) {
            const element = document.getElementById(elementId);
            if (!element) return;

            const elementPosition = element.getBoundingClientRect().top + window.pageYOffset;
            const offsetPosition = elementPosition - offset;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }

        // Debounce function for performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Throttle function for scroll events
        function throttle(func, limit) {
            let inThrottle;
            return function(...args) {
                if (!inThrottle) {
                    func.apply(this, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }

        // Lazy load images
        function lazyLoadImages() {
            const images = document.querySelectorAll('img[data-src]');

            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                        observer.unobserve(img);
                    }
                });
            });

            images.forEach(img => imageObserver.observe(img));
        }

        // Detect if element is in viewport
        function isInViewport(element) {
            const rect = element.getBoundingClientRect();
            return (
                rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                rect.right <= (window.innerWidth || document.documentElement.clientWidth)
            );
        }

        // Add touch feedback for mobile
        function addTouchFeedback() {
            if ('ontouchstart' in window) {
                document.querySelectorAll('a, button').forEach(el => {
                    el.addEventListener('touchstart', function() {
                        this.style.opacity = '0.7';
                    });
                    el.addEventListener('touchend', function() {
                        this.style.opacity = '1';
                    });
                });
            }
        }

        // Handle responsive tables
        function makeTablesResponsive() {
            const tables = document.querySelectorAll('table');
            tables.forEach(table => {
                if (!table.parentElement.classList.contains('table-responsive')) {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'overflow-x-auto';
                    table.parentNode.insertBefore(wrapper, table);
                    wrapper.appendChild(table);
                }
            });
        }

        // Initialize everything when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize sidebar
            new SidebarManager();

            // Initialize modals
            const modalIds = ['questionModalOverlay', 'followersModalOverlay', 'followingModalOverlay'];
            modalIds.forEach(id => {
                if (document.getElementById(id)) {
                    new ModalManager(id);
                }
            });

            // Add touch feedback on mobile
            addTouchFeedback();

            // Make tables responsive
            makeTablesResponsive();

            // Lazy load images
            if ('IntersectionObserver' in window) {
                lazyLoadImages();
            }

            // Log current breakpoint (for debugging)
            console.log('Current breakpoint:', ResponsiveUtils.getBreakpoint());
        });

        // Handle window resize
        window.addEventListener('resize', debounce(() => {
            console.log('Breakpoint changed to:', ResponsiveUtils.getBreakpoint());
        }, 250));

        // Prevent body scroll when modal is open
        function preventBodyScroll(shouldPrevent) {
            if (shouldPrevent) {
                document.body.style.overflow = 'hidden';
                document.body.style.paddingRight = window.innerWidth - document.documentElement.clientWidth + 'px';
            } else {
                document.body.style.overflow = '';
                document.body.style.paddingRight = '';
            }
        }

        // Export utilities for use in other scripts
        window.ResponsiveUtils = ResponsiveUtils;
        window.smoothScrollTo = smoothScrollTo;
        window.debounce = debounce;
        window.throttle = throttle;
        window.preventBodyScroll = preventBodyScroll;
    </script>

    <!-- modal section -->


    <script>
        const createBtn = document.getElementById('createBtn');
        const modalOverlay = document.getElementById('modalOverlay');
        const modalContent = document.querySelector('.modal-content');
        const closeBtn = document.getElementById('closeBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const questionForm = document.getElementById('questionForm');
        const successMessage = document.getElementById('successMessage');
        const imageInput = document.getElementById('image');
        const imagePreview = document.getElementById('imagePreview');

        // Open modal
        createBtn.addEventListener('click', () => {
            modalOverlay.classList.remove('hidden');
            modalOverlay.classList.add('flex');
            modalContent.classList.remove('closing');
        });

        // Close modal function with animation
        function closeModal() {
            modalOverlay.classList.add('closing');
            modalContent.classList.add('closing');

            setTimeout(() => {
                modalOverlay.classList.add('hidden');
                modalOverlay.classList.remove('flex', 'closing');
                modalContent.classList.remove('closing');
                questionForm.reset();
                imagePreview.textContent = '';
            }, 400);
        }

        // Close button
        closeBtn.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);

        // Close on overlay click
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                closeModal();
            }
        });

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !modalOverlay.classList.contains('hidden')) {
                closeModal();
            }
        });

        // Image preview
        imageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                imagePreview.textContent = `Selected: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
            } else {
                imagePreview.textContent = '';
            }
        });

        // Form submission
        questionForm.addEventListener('submit', async(e) => {
            e.preventDefault();

            const formData = new FormData(questionForm);

            try {
                // Django CSRF token থাকলে add করুন
                const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]') ? .value;

                const response = await fetch('/your-django-url-endpoint/', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': csrfToken || '',
                    }
                });

                if (response.ok) {
                    // Show success message
                    successMessage.classList.remove('hidden');
                    setTimeout(() => {
                        successMessage.classList.add('hidden');
                    }, 3000);

                    // Close modal
                    closeModal();

                    // Optionally reload or redirect
                    // window.location.reload();
                } else {
                    alert('Error creating question. Please try again.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error creating question. Please try again.');
            }
        });
    </script>




    <!-- Script js -->
    <script src="{% static 'js/script.js' %} "></script>
</body>

</html>