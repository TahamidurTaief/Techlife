{% load static %}
<section class="min-h-screen bg-white -mt-[30px]">

    <div class=" mx-auto px-4 py-8">
        <!-- Profile Header Card -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6">
            <!-- Cover Image -->
            <div class="h-40 bg-cover bg-center rounded-t-lg " style="background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTAsqu-SzrO3QVKsfs1BC-Tx-OQDWdWUD5qsZ5rrBS0&s')">
            </div>
            <!-- Profile Info -->
            <div class=" px-8 pb-8 pt-10 ">
                <div class="flex flex-col md:flex-row items-center md:items-end -mt-16 md:-mt-20 ">
                    <!-- Profile Picture -->
                    <img src="{{ user_profile.profile_picture.url }} " alt="Profile " class="w-32 h-32 rounded-full border-4 border-white shadow-md mb-4 md:mb-0 md:mr-6 ">

                    <!-- User Info -->
                    <div class="flex-1 text-center md:text-left mb-4 md:mb-0 mt-2 ">
                        <h1 class="text-3xl font-bold text-gray-900 mb-1 ">{{ user_profile.first_name }} {{ user_profile.last_name }}</h1>
                        <p class="text-gray-600 mb-2 ">{{ user_profile.email }}</p>
                    </div>

                    <!-- Stats -->
                    <div class="flex gap-6 ">
                        <div class="text-center ">
                            <div class="text-2xl font-bold text-blue-600 ">{{ all_blogs.count }}</div>
                            <div class="text-xs text-gray-500 uppercase ">Blog Posts</div>
                        </div>
                        <div class="text-center ">
                            <div class="text-2xl font-bold text-blue-600 ">{{ all_questions.count }}</div>
                            <div class="text-xs text-gray-500 uppercase ">Forum Q&A</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="bg-white rounded-lg shadow-sm mb-4 ">
            <div class="border-b border-gray-200 ">
                <nav class="flex -mb-px">
                    <button onclick="showTab('posts')" id="tab-posts" class="tab-button active py-4 px-8 font-semibold text-blue-600 border-b-2 border-blue-600 transition-colors ">
                        Blog Posts
                    </button>
                    <button onclick="showTab('forum')" id="tab-forum" class="tab-button py-4 px-8 font-semibold text-gray-500 border-b-2 border-transparent hover:text-gray-700 hover:border-gray-300 transition-colors ">
                        Forum Questions
                    </button>
                </nav>
            </div>
        </div>

        <!-- Blog Posts Tab Content -->
        <div id="content-posts" class="tab-content">
            <!-- Blog Posts Grid -->
            <div class=" mx-auto grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-4 ">

                {% for blog in user_blogs %}
                <a href="{% url 'blog_details' blog.slug %}" class="bg-white rounded-md overflow-hidden hover:drop-shadow-md duration-200 pb-2 mb-6 cursor-pointer border border-gray-200 hover:border-gray-300 ">
                    <!-- Image section -->
                    <div class="relative p-3 pt-3 ">
                        {% if blog.featured_image %}
                        <img src="{{ blog.featured_image.url }}" alt="{{ blog.title }}" class="w-full h-44 object-cover rounded-md " /> {% elif blog.featured_image_url %}
                        <img src="{{ blog.featured_image_url }}" alt="{{ blog.title }}" class="w-full h-44 object-cover rounded-md " /> {% else %}
                        <img src="{% static 'image/placeholder-5.png' %}" alt="{{ blog.title }} " class="w-full h-44 object-cover rounded-md " /> {% endif %}
                    </div>

                    <!-- Category name and date -->
                    <div class="flex flex-row items-center justify-between mt-2 px-3 py-2 ">
                        <span class="bg-blue-100 text-gray-800 px-3 py-1 text-xs rounded-full font-medium hover:bg-blue-500 hover:text-white duration-300 ">{{blog.category.name|truncatewords:1 }}</span>
                        <p class="text-gray-500 text-sm ">{{ blog.created_at|date:"d M, Y " }}</p>
                    </div>

                    <!-- Title & Description -->
                    <div class="mb-1 px-3 ">
                        <h3 class="font-semibold text-gray-800 text-md line-clamp-1 hover:text-blue-500 duration-300 font-inter ">
                            {{ blog.title }}</h3>
                        <div class="mt-2 ">
                            <p class="text-gray-500 font-normal text-xs h-15 font-inter ">{{ blog.description|truncatechars:80 }}
                            </p>
                        </div>
                    </div>

                    <!-- Read more & Stats -->
                    <div class="flex items-center justify-between px-3 ">
                        <span class="flex flex-row gap-1 text-xs items-center text-blue-500 font-normal group cursor-pointer ">
                            Read more
                            <svg class="w-4 h-4 group-hover:translate-x-1 duration-300 "
                                xmlns="http://www.w3.org/2000/svg" fill="none " viewBox="0 0 24 24 " stroke-width="1.5 "
                                stroke="currentColor ">
                                <path stroke-linecap="round " stroke-linejoin="round "
                                    d="M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3 " />
                            </svg>
                        </span>

                        <span class="flex flex-row gap-1 text-xs items-center text-gray-700 font-normal group cursor-pointer ">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24 " fill="currentColor "
                                class="w-4 h-4 text-gray-500 ">
                                <path fill-rule="evenodd "
                                    d="M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.73 0-5.45-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z "
                                    clip-rule="evenodd " />
                            </svg>
                            {{ blog.author.last_name }}

                        </span> {% comment %}
                        <!-- Stats -->
                        <div class="flex items-center text-gray-600 text-sm gap-5 mt-3 ">
                            <span class="flex items-center gap-1 ">
                                <i class="fa-solid fa-eye "></i>
                                {{ blog.views }}
                            </span>
                            <span class="flex items-center gap-1 ">
                                <i class="fa-solid fa-thumbs-up "></i>
                                {{ blog.likes }}
                            </span>
                            <span class="flex items-center gap-1 ">
                                <i class="fa-solid fa-share-nodes "></i>
                                {{ blog.shares.count }}
                            </span>
                        </div> {% endcomment %}
                    </div>
                </a>
                {% empty %}
                <div class="col-span-full flex flex-col items-center justify-center py-16 px-4 border-2 border-dashed border-gray-200 rounded-2xl bg-gray-50/50 ">
                    <div class="mb-5 p-5 bg-white rounded-full shadow-sm ">
                        <svg class="w-12 h-12 text-gray-300 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                        <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.5 " d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10l4 4v10a2 2 0 01-2 2z "></path>
                        <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.5 " d="M14 4v4h4m-10 4h8m-8 4h5 "></path>
                    </svg>
                    </div>

                    <h3 class="text-xl font-bold text-gray-900 mb-2 ">No articles found</h3>
                    <p class="text-gray-500 text-center max-w-sm mb-8 ">
                        It looks like there are no blog posts available at the moment.
                    </p>

                    <a href="{% url 'create_blog' %}" class="inline-flex items-center px-6 py-3 bg-blue-700 text-white text-sm font-semibold rounded-xl hover:bg-blue-800 transition-all shadow-md hover:shadow-lg active:scale-95 ">
        
                        Write Post
                    </a>
                </div>
                {% endfor %}

            </div>

            {% if user_blogs %}
            <div class="mt-16 mb-10 flex justify-center ">
                <nav class="flex items-center gap-1 p-1 bg-white/80 backdrop-blur-md border border-gray-200/60 rounded-2xl shadow-sm ring-1 ring-black/5 " aria-label="Pagination ">

                    {% if user_blogs.has_previous %}
                    <a href="?page={{ user_blogs.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %} " class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all
                    duration-200 " title="Previous ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 "
                                d="M15 19l-7-7 7-7 " />
                        </svg>
                    </a>
                    {% else %}
                    <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 "
                                d="M15 19l-7-7 7-7 " />
                        </svg>
                    </span> {% endif %}

                    <div class="flex items-center px-4 h-10 bg-gray-50/50 rounded-xl border border-gray-100 mx-1 ">
                        <span class="text-xs font-bold uppercase tracking-widest text-gray-400 mr-2 ">Page</span>
                        <span class="text-sm font-semibold text-blue-600 ">{{ user_blogs.number }}</span>
                        <span class="text-sm font-medium text-gray-300 mx-2 ">of</span>
                        <span class="text-sm font-semibold text-gray-600 ">{{ user_blogs.paginator.num_pages }}</span>
                    </div>

                    {% if user_blogs.has_next %}
                    <a href="?page={{ user_blogs.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %} " class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all
                        duration-200 " title="Next ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M9 5l7 7-7 7 " />
                        </svg>
                    </a>
                    {% else %}
                    <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M9 5l7 7-7 7 " />
                        </svg>
                    </span> {% endif %}

                </nav>
            </div>
            {% endif %}

        </div>

        <!-- Forum Questions Tab Content -->
        <div id="content-forum" class="tab-content hidden ">
            <div class="space-y-4 ">

                <!-- Forum Question Card 1 -->
                {% for question in user_questions %}
                <div class="border border-gray-200 bg-white rounded-lg hover:shadow-sm duration-300 p-6 ">
                    <div class="flex gap-4 ">
                        <div class="flex flex-col items-center gap-2 ">
                            <button class="text-blue-700 ">
                                <svg class="w-6 h-6 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                                    <path stroke-linecap="round " stroke-linejoin="round " stroke-width="2 "
                                        d="M5 15l7-7 7 7 "></path>
                                </svg>
                            </button>
                            <span class="text-xl font-semibold text-gray-500 ">{{ forloop.counter }}</span>
                            <button class="text-blue-700 ">
                                <svg class="w-6 h-6 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                                    <path stroke-linecap="round " stroke-linejoin="round " stroke-width="2 "
                                        d="M19 9l-7 7-7-7 "></path>
                                </svg>
                            </button>
                        </div>

                        <div class="flex-1 ">
                            <a hx-get="{% url 'questions' slug=question.slug %} " hx-target="#blog_post_form" hx-swap="innerHTML" hx-push-url="true" class="font-inter text-[18px] font-semibold text-gray-900 mb-2 hover:text-blue-800 cursor-pointer line-clamp-2 ">
                                {{ question.title }}
                            </a>
                            <p class="font-inter text-gray-600 mb-4 text-[12px] line-clamp-3 ">
                                {{ question.content }}
                            </p>
                            <!-- <div class="flex flex-wrap gap-2 mb-3 ">
                                <span class="px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded-full ">react</span>
                                <span class="px-3 py-1 bg-green-100 text-green-700 text-xs rounded-full ">performance</span>
                                <span class="px-3 py-1 bg-purple-100 text-purple-700 text-xs rounded-full ">optimization</span>
                            </div> -->
                            <div class="flex items-center gap-4 text-sm text-gray-500 ">
                                <span>Asked {{ question.created_at|timesince }} ago</span>
                                <span class="flex items-center gap-1 ">
                                    <svg class="w-4 h-4 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                                        <path stroke-linecap="round " stroke-linejoin="round " stroke-width="2 "
                                            d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z ">
                                        </path>
                                    </svg>
                                    {{ question.answers.count }} answers
                                </span>
                                <!-- <span class="flex items-center gap-1 ">
                                    <svg class="w-4 h-4 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                                        <path stroke-linecap="round " stroke-linejoin="round " stroke-width="2 "
                                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z "></path>
                                        <path stroke-linecap="round " stroke-linejoin="round " stroke-width="2 "
                                            d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z ">
                                        </path>
                                    </svg>
                                 views
                                </span> -->
                            </div>
                        </div>
                    </div>
                </div>

                {% empty %}
                <div class="flex flex-col items-center justify-center py-16 px-4 border-2 border-dashed border-gray-200 rounded-2xl bg-gray-50 ">
                    <div class="mb-4 p-4 bg-white rounded-full shadow-sm ">
                        <svg class="w-10 h-10 text-gray-400 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                        <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.5 " d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2
                    2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z "></path>
                    </svg>
                    </div>

                    <h3 class="text-lg font-bold text-gray-900 ">No questions yet</h3>
                    <p class="text-sm text-gray-500 mb-6 text-center ">Be the first to start a discussion!</p>

                    <a href="{% url 'create_question' %} " class="px-5 py-2.5 bg-blue-700 text-white text-sm font-medium rounded-lg hover:bg-blue-800 transition shadow-sm ">
                            Ask a Question
                        </a>
                </div>
                {% endfor %}


            </div>

            {% if user_questions %}
            <div class="mt-16 mb-10 flex justify-center ">
                <nav class="flex items-center gap-1 p-1 bg-white/80 backdrop-blur-md border border-gray-200/60 rounded-2xl shadow-sm ring-1 ring-black/5 " aria-label="Pagination ">

                    {% if user_questions.has_previous %}
                    <a href="?page={{ user_questions.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %} " class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all
                duration-200 " title="Previous ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 "
                                d="M15 19l-7-7 7-7 " />
                        </svg>
                    </a>
                    {% else %}
                    <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 "
                                d="M15 19l-7-7 7-7 " />
                        </svg>
                    </span> {% endif %}

                    <div class="flex items-center px-4 h-10 bg-gray-50/50 rounded-xl border border-gray-100 mx-1 ">
                        <span class="text-xs font-bold uppercase tracking-widest text-gray-400 mr-2 ">Page</span>
                        <span class="text-sm font-semibold text-blue-600 ">{{ user_questions.number }}</span>
                        <span class="text-sm font-medium text-gray-300 mx-2 ">of</span>
                        <span class="text-sm font-semibold text-gray-600 ">{{ user_questions.paginator.num_pages }}</span>
                    </div>

                    {% if user_questions.has_next %}
                    <a href="?page={{ user_questions.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %} " class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all
                duration-200 " title="Next ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M9 5l7 7-7 7 " />
                        </svg>
                    </a>
                    {% else %}
                    <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed ">
                        <svg class="w-5 h-5 " fill="none " stroke="currentColor " viewBox="0 0 24 24 ">
                            <path stroke-linecap="round " stroke-linejoin="round " stroke-width="1.75 " d="M9 5l7 7-7 7 " />
                        </svg>
                    </span> {% endif %}

                </nav>
            </div>
            {% endif %}
        </div>

    </div>


</section>


<script>
    function showTab(tabName) {
        // Hide all tab contents
        const contents = document.querySelectorAll('.tab-content');
        contents.forEach(content => content.classList.add('hidden'));

        // Remove active class from all tabs
        const tabs = document.querySelectorAll('.tab-button');
        tabs.forEach(tab => {
            tab.classList.remove('active', 'text-blue-600', 'border-blue-600');
            tab.classList.add('text-gray-500', 'border-transparent');
        });

        // Show selected tab content
        document.getElementById('content-' + tabName).classList.remove('hidden');

        // Add active class to selected tab
        const activeTab = document.getElementById('tab-' + tabName);
        activeTab.classList.add('active', 'text-blue-600', 'border-blue-600');
        activeTab.classList.remove('text-gray-500', 'border-transparent');
    }
</script>