{% load static %}

<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />


    <!-- Primary Meta Tags -->
    <title>
        {% block title %} TechLife || Know The Current Situation {% endblock title %}
    </title>
    {% comment %} {% tailwind_css %} {% endcomment %}
    <meta name="description" content="{% block meta_description %}Discover a wide range of high-quality products at unbeatable prices. Your one-stop shop for electronics, fashion, and more.{% endblock meta_description %}" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ request.build_absolute_uri }}" />
    <meta property="og:title" content="{% block og_title %}{% block title_for_socials %}{{ self.title }}{% endblock %}{% endblock %}" />
    <meta property="og:description" content="{% block og_description %}{% block description_for_socials %}{{ self.meta_description }}{% endblock %}{% endblock %}" />
    <meta property="og:image" content="{% block og_image %}{% static 'images/default_og_image.png' %}{% endblock og_image %}" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="{{ request.build_absolute_uri }}" />
    <meta property="twitter:title" content="{% block twitter_title %}{% block title_for_socials_twitter %}{{ self.og_title }}{% endblock %}{% endblock %}" />
    <meta property="twitter:description" content="{% block twitter_description %}{% block description_for_socials_twitter %}{{ self.og_description }}{% endblock %}{% endblock %}" />
    <meta property="twitter:image" content="{% block twitter_image %}{% block og_image_twitter %}{{ self.og_image }}{% endblock %}{% endblock %}" />

    <!-- HTMX CSRF -->
    {% csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token }}" /> {% comment %} emoji picker {% endcomment %}
    <!-- <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script> -->

    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="{% static 'css/output.css' %}" />

    <!-- Latest Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-e..." crossorigin="anonymous" referrerpolicy="no-referrer" />



    <!-- tailwind cdn -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <!-- HTMX & Alpine.js -->
    {% comment %}
    <script src="https://unpkg.com/htmx.org@1.9.12" xintegrity="sha384-qbtR4rS9adLkqseSremUcbR/vgFA2A6XPKYoHCi8S4EbMLjI/RJjVqEX+qtYLaqd" crossorigin="anonymous">
    </script> {% endcomment %}
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>

    {% comment %} AOS animation {% endcomment %}
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <!-- Unicons -->
    <!-- <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css" /> {% comment %} icon {% endcomment %} -->

    <!-- DaisyUI Play CDN -->

    <!-- <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" /> -->

    <!-- Poppins Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer"
    /> {% block extra_head %} {% endblock extra_head %}


    <!-- favicon section -->
    <link rel="icon" type="image/x-icon" href="{% static 'image/company_logo.webp' %}">
    <link rel="icon" type="image/webp" href="{% static 'image/company_logo.webp' %}">
    <link rel="apple-touch-icon" href="{% static 'image/company_logo.webp' %}">

    <style>
        .category-header-bg {
            background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, .05), rgba(255, 255, 255, .05) 10px, transparent 10px, transparent 20px);
        }
    </style>

    <!-- loader -->
    <style>
        #loader-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            /* Background color */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            /* Sob kichur upore thakbe */
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            /* Loader er color */
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        /* Page load hoye gele loader hide korar class */
        
        .loader-hidden {
            opacity: 0;
            visibility: hidden;
        }
    </style>

</head>

<body id="user_dashboard" class="font-inter leading-normal tracking-normal bg-white">

    <!-- loader -->
    <div id="loader-wrapper">
        <div class="loader"></div>
    </div>

    {% include 'include/navbar.html' %} {% include 'include/notification.html' %}



    <!-- Main Content -->
    <main id="container" class="container mt-9 mx-auto flex-grow min-h-[calc(100vh-128px)] py-6 bg-white">

        {% block content %}
        <!-- Page content here -->
        {% if action == 'post_create' %} {% include 'components/blogs/partial_create_blog_content.html' %} {% elif action == 'home_page' %} {% include 'components/home/home_page.html' %} {% elif action == 'all_blogs' %} {% include 'components/blogs/partial_all_blog_page.html'
        %} {% elif action == 'contact_page' %} {% include 'partial_contact_us_page.html' %} {% elif action == 'category_post' %} {% include 'components/category/category_post_partial.html' %} {% elif action == 'popular_blogs' %} {% include 'components/popular/popular_post_partial.html'
        %} {% elif action == 'all_article' %} {% include 'components/category/all_article_partial.html' %} {% elif action == 'popular_category_post' %} {% include 'components/popular/popular_category_post_partial.html' %} {% elif action == 'blog_details'
        %} {% include 'components/blog_details/partial_blog_details_page.html' %} {% elif action == 'right_side_update_in_blog_details' %} {% include 'components/blog_details/blog_right_side_partial.html' %} {% endif %} {% endblock content %}

    </main>

    {% include 'include/footer.html' %}


    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        lucide.createIcons();
    </script>



    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <script>
        document.body.addEventListener('htmx:afterSwap', (event) => {
            if (window.Alpine) {
                window.Alpine.initTree(event.target);
            }
        });
    </script>

    <script>
        document.body.addEventListener('htmx:afterSwap', (event) => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    </script>

    <script>
        function initializeDynamicContent() {
            const shareBtn = document.getElementById('shareBtn');
            const shareModal = document.getElementById('shareModal');
            const closeModal = document.getElementById('closeModal');
            const shareLinks = document.querySelectorAll('.share-link');
            const dataContainer = document.getElementById('share-data-container');

            if (shareBtn && shareModal) {
                shareBtn.onclick = () => {
                    shareModal.classList.remove('hidden');
                };
            }
            if (closeModal && shareModal) {
                closeModal.onclick = () => {
                    shareModal.classList.add('hidden');
                };
            }
            if (shareModal) {
                shareModal.onclick = (e) => {
                    if (e.target === shareModal) {
                        shareModal.classList.add('hidden');
                    }
                };
            }
            if (dataContainer) {
                const postId = dataContainer.dataset.postId;
                const shareUrl = dataContainer.dataset.shareUrl;
                const csrfToken = dataContainer.dataset.csrfToken;
                const postUrl = encodeURIComponent(window.location.href);
                shareLinks.forEach((link) => {
                    link.onclick = null;
                    link.onclick = (e) => {
                        e.preventDefault();
                        const platform = link.dataset.platform;
                        let url = '';

                        switch (platform) {
                            case 'facebook':
                                url = `https://www.facebook.com/sharer/sharer.php?u=${postUrl}`;
                                break;
                            case 'linkedin':
                                url = `https://www.linkedin.com/shareArticle?mini=true&url=${postUrl}`;
                                break;
                            case 'twitter':
                                url = `https://twitter.com/intent/tweet?url=${postUrl}`;
                                break;
                            case 'whatsapp':
                                url = `https://api.whatsapp.com/send?text=${postUrl}`;
                                break;
                        }
                        window.open(url, '_blank', 'width=600,height=400');

                        fetch(shareUrl, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/x-www-form-urlencoded',
                                    'X-CSRFToken': csrfToken
                                },
                                body: `post_id=${postId}&platform=${platform}`
                            })
                            .then((res) => res.json())
                            .then((data) => {
                                if (data.status === 'success') {
                                    console.log(`Share recorded on ${platform}!`);
                                } else {
                                    console.error('Share record failed:', data.message);
                                }
                            })
                            .catch((err) => console.error('AJAX error:', err));
                    };
                });
            }

            let speech = null;
            const titleElement = document.getElementById('blog-title');
            const descriptionElement = document.getElementById('blog-description');
            const mainAudioBtn = document.getElementById('main-audio-btn');
            const stopBtn = document.getElementById('stop-btn');
            const iconDisplay = document.getElementById('icon-display');
            const synth = window.speechSynthesis;
            if (mainAudioBtn) {
                if (synth.speaking || synth.paused) {
                    synth.cancel();
                }

                function updateUI(isSpeaking, isPaused) {
                    if (!iconDisplay || !mainAudioBtn || !stopBtn) return;
                    if (isSpeaking) {
                        if (isPaused) {
                            iconDisplay.textContent = '▶';
                            mainAudioBtn.title = 'Resume';
                        } else {
                            iconDisplay.textContent = '⏸';
                            mainAudioBtn.title = 'Pause';
                        }
                        stopBtn.disabled = false;
                    } else {
                        iconDisplay.textContent = '▶';
                        mainAudioBtn.title = 'Listen';
                        stopBtn.disabled = true;
                    }
                }
                mainAudioBtn.onclick = () => {
                    if (synth.paused) {
                        synth.resume();
                        updateUI(true, false);
                        return;
                    }
                    if (synth.speaking) {
                        synth.pause();
                        updateUI(true, true);
                        return;
                    }
                    const titleText = titleElement ? titleElement.textContent : '';
                    const descriptionText = descriptionElement ? descriptionElement.textContent : '';
                    const textToSpeak = titleText + '. ' + descriptionText;
                    if (!textToSpeak.trim()) {
                        console.warn('No text content found to speak.');
                        return;
                    }
                    speech = new SpeechSynthesisUtterance(textToSpeak);
                    speech.lang = 'bn-BD';
                    synth.speak(speech);
                    updateUI(true, false);
                    speech.onend = () => {
                        updateUI(false, false);
                    };
                    speech.onerror = (event) => {
                        console.error('Speech synthesis error:', event);
                        updateUI(false, false);
                    };
                };
                stopBtn.onclick = () => {
                    if (synth.speaking || synth.paused) {
                        synth.cancel();
                        updateUI(false, false);
                    }
                };
                updateUI(false, false);
            }

            document.querySelectorAll('.reply-btn').forEach((btn) => {
                btn.onclick = function() {
                    const form = this.closest('div').parentNode.querySelector('.reply-form');
                    if (form) {
                        form.classList.toggle('hidden');
                    }
                };
            });
        }
        document.addEventListener('DOMContentLoaded', initializeDynamicContent);
        document.body.addEventListener('htmx:afterSwap', function(evt) {
            if (evt.detail.target && evt.detail.target.id === 'container') {
                initializeDynamicContent(); // 
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
                if (typeof AOS !== 'undefined') {
                    AOS.refresh();
                }
            }
        });

        document.body.addEventListener('htmx:beforeRequest', function(evt) {
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '0.6';
                content.style.transition = 'opacity 0.2s ease';
            }
        });
        document.body.addEventListener('htmx:afterRequest', function(evt) {
            const content = document.getElementById('content');
            if (content) {
                content.style.opacity = '1';
            }
        });

        document.body.addEventListener('htmx:responseError', function(evt) {
            console.error('HTMX Error:', evt.detail);
            const content = document.getElementById('content');
            if (content) {
                content.innerHTML = `
            <div class="flex flex-col items-center justify-center min-h-[400px] text-center">
                <h2 class="text-xl font-bold text-red-600 mb-4">Something went wrong</h2>
                <p class="text-gray-600 mb-6">Unable to load the content. Please try again.</p>
                <button onclick="window.location.reload()" 
                        class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    Refresh Page
                </button>
            </div>
            `;
                content.style.opacity = '1';
            }
        });

        document.body.addEventListener('htmx:afterSettle', function(evt) {
            const titleElement = evt.detail.target.querySelector('title, [data-title]');
            if (titleElement) {
                document.title = titleElement.textContent || titleElement.getAttribute('data-title');
            }
        });
    </script>


    <!-- Script js -->
    <script src="{% static 'js/script.js' %}"></script>

    <script>
        AOS.init();
    </script>



    <!-- loader -->
    <script>
        window.addEventListener("load", function() {
            const loader = document.getElementById("loader-wrapper");
            loader.classList.add("loader-hidden");
        });
    </script>


    <!-- scroll top -->

    <button id="scrollToTop" class="cursor-pointer fixed bottom-6 right-6 md:bottom-28 md:right-8 z-[9999] translate-y-20 opacity-0 invisible bg-blue-400 text-white p-3 rounded-full hover:bg-blue-600 active:scale-90 transition-all duration-500 group" onclick="window.scrollTo({top: 0, behavior: 'smooth'})"
        aria-label="Scroll to top">
    <svg class="w-6 h-6 transform group-hover:-translate-y-0.5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/>
    </svg>
</button>

    <style>
        .show-scroll-btn {
            visibility: visible !important;
            opacity: 1 !important;
            transform: translateY(0) !important;
        }
    </style>

    <script>
        const scrollBtn = document.getElementById('scrollToTop');

        // Check korar jonno (Browser console-e dekhbe error thake kina)
        if (!scrollBtn) {
            console.error("Scroll button element-ti pawa jayni!");
        }

        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                scrollBtn.classList.add('show-scroll-btn');
            } else {
                scrollBtn.classList.remove('show-scroll-btn');
            }
        });
    </script>
</body>






<!-- Script js -->
<script src="{% static 'js/script.js' %}"></script>

<script>
    AOS.init();
</script>
</body>

</html>